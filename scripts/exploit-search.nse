local nmap = require "nmap"

description = [[
Queries the ExploitSearch service to submit version detection results and
display related vulnerabilities according to this search engine.
]]

---
-- @args strict Enable strict search, matching ALL (instead of ANY) detections (optional).
-- @usage
-- nmap target --script exploit-search
-- @output
-- TODO: add some output example

author = "CeSeNA Security"
license = "Same as Nmap--See http://nmap.org/book/man-legal.html"
categories = { "discovery", "safe", "external" }
dependencies = {} -- no deps

prerule = function(host, port)
  local port_info = nmap.get_port_state(host, port)

  -- Keep only available services.
  return     port_info       ~= nil
         and port_info.state == "open"
end

action = function(host, port)
  local base_url = "http://www.exploitsearch.net/json.php?q="
  local port_info = nmap.get_port_state(host, port)
  -- TODO
  return port_info
end
